var Qe=Object.defineProperty,Je=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var $e=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var Le=(e,n,a)=>n in e?Qe(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,k=(e,n)=>{for(var a in n||(n={}))et.call(n,a)&&Le(e,a,n[a]);if($e)for(var a of $e(n))tt.call(n,a)&&Le(e,a,n[a]);return e},Y=(e,n)=>Je(e,xe(n));var B=(e,n,a)=>new Promise((i,l)=>{var f=o=>{try{s(a.next(o))}catch(t){l(t)}},p=o=>{try{s(a.throw(o))}catch(t){l(t)}},s=o=>o.done?i(o.value):Promise.resolve(o.value).then(f,p);s((a=a.apply(e,n)).next())});import{p as w,v as we,k as X,m as H,_ as V,N as ne,X as nt,O as ke,Y as at,I as Oe,Z as ot,$ as lt,f as st,a0 as it,n as rt,S as ut,U as Re,b as dt,a1 as ct,w as pt}from"./index.js";import{u as oe}from"./useFormItem-14b12386.js";import{ac as de,o as le,a7 as Q,N as De,ad as Ce,ae as ft,af as Be,ag as Se,ah as mt,ai as gt,aj as ce,M as ht,ak as Te,f as he,$ as Ne,al as yt,T as Me,am as vt,an as bt,H as ye,X as St,Q as wt,w as se,ao as Ct,ap as _t,aq as At,Z as Ee,ar as Ft,as as $t,at as pe,au as Ge}from"./antd-201c8368.js";import{d as G,f as _,c as P,h as _e,w as I,u as L,a7 as S,Z as C,a8 as R,a9 as F,_ as M,aa as ie,F as ee,E as K,a0 as E,ac as Z,ad as fe,N as me,ai as te,aj as ge,l as y,$ as ae,o as Ae,r as je,ab as z,p as Lt,e as kt,H as Pe,a1 as ve,x as Ue,G as Rt}from"./vue-ea98dac5.js";import{R as Tt}from"./RadioButtonGroup-a85e25e5.js";import{b as Pt,a as Ut}from"./uuid-a2a47690.js";import{u as It,B as ze,a as Ke,b as Ie}from"./index-10820036.js";import{u as Ot}from"./useSortable-3cb9ef53.js";import{d as Dt}from"./download-2647fd8d.js";import{S as Bt}from"./index-5b47f6d9.js";import{_ as Nt}from"./IconPicker.vue_vue_type_script_setup_true_lang-eb395492.js";import{C as Mt}from"./index-55225be0.js";const Et=G({name:"ApiRadioGroup",components:{RadioGroup:de.Group,RadioButton:de.Button,Radio:de},props:{api:{type:Function,default:null},params:{type:[Object,String],default:()=>({})},value:{type:[String,Number,Boolean]},isBtn:{type:[Boolean],default:!1},numberToString:w.bool,resultField:w.string.def(""),labelField:w.string.def("label"),valueField:w.string.def("value"),immediate:w.bool.def(!0)},emits:["options-change","change"],setup(e,{emit:n}){const a=_([]),i=_(!1),l=_(!0),f=_([]),p=we(),{t:s}=X(),[o]=oe(e,"value","change",f),t=P(()=>{const{labelField:g,valueField:d,numberToString:m}=e;return L(a).reduce((h,v)=>{if(v){const $=v[d];h.push(k({label:v[g],value:m?`${$}`:$},le(v,[g,d])))}return h},[])});_e(()=>{e.immediate&&u()}),I(()=>e.params,()=>{!L(l)&&u()},{deep:!0});function u(){return B(this,null,function*(){const g=e.api;if(!(!g||!H(g))){a.value=[];try{i.value=!0;const d=yield g(e.params);if(Array.isArray(d)){a.value=d,r();return}e.resultField&&(a.value=Q(d,e.resultField)||[]),r()}catch(d){}finally{i.value=!1}}})}function r(){n("options-change",L(t))}function c(...g){f.value=g}return{state:o,getOptions:t,attrs:p,loading:i,t:s,handleClick:c,props:e}}});function Gt(e,n,a,i,l,f){const p=S("RadioButton"),s=S("Radio"),o=S("RadioGroup");return C(),R(o,Z(e.attrs,{value:e.state,"onUpdate:value":n[0]||(n[0]=t=>e.state=t),"button-style":"solid"}),{default:F(()=>[(C(!0),M(ee,null,ie(e.getOptions,t=>(C(),M(ee,{key:`${t.value}`},[e.props.isBtn?(C(),R(p,{key:0,value:t.value,disabled:t.disabled,onClick:u=>e.handleClick(t)},{default:F(()=>[K(E(t.label),1)]),_:2},1032,["value","disabled","onClick"])):(C(),R(s,{key:1,value:t.value,disabled:t.disabled,onClick:u=>e.handleClick(t)},{default:F(()=>[K(E(t.label),1)]),_:2},1032,["value","disabled","onClick"]))],64))),128))]),_:1},16,["value"])}const jt=V(Et,[["render",Gt]]),zt=G({name:"ApiSelect",components:{Select:De,LoadingOutlined:Ce},inheritAttrs:!1,props:{value:{type:[Array,Object,String,Number]},numberToString:w.bool,api:{type:Function,default:null},params:w.any.def({}),resultField:w.string.def(""),labelField:w.string.def("label"),valueField:w.string.def("value"),immediate:w.bool.def(!0),alwaysLoad:w.bool.def(!1),options:{type:Array,default:[]}},emits:["options-change","change","update:value"],setup(e,{emit:n}){const a=_([]),i=_(!1),l=_(!1),f=_([]),p=we(),{t:s}=X(),[o]=oe(e,"value","change",f),t=P(()=>{const{labelField:d,valueField:m,numberToString:h}=e;let v=L(a).reduce(($,U)=>{if(U){const j=Q(U,m);$.push(Y(k({},le(U,[d,m])),{label:Q(U,d),value:h?`${j}`:j}))}return $},[]);return v.length>0?v:e.options});I(()=>o.value,d=>{n("update:value",d)}),I(()=>e.params,()=>{!L(l)&&u()},{deep:!0,immediate:e.immediate});function u(){return B(this,null,function*(){const d=e.api;if(!(!d||!H(d)||i.value)){a.value=[];try{i.value=!0;const m=yield d(e.params);if(l.value=!0,Array.isArray(m)){a.value=m,c();return}e.resultField&&(a.value=Q(m,e.resultField)||[]),c()}catch(m){}finally{i.value=!1,l.value=!1}}})}function r(d){return B(this,null,function*(){d&&(e.alwaysLoad?yield u():!e.immediate&&!L(l)&&(yield u()))})}function c(){n("options-change",L(t))}function g(d,...m){f.value=m}return{state:o,attrs:p,getOptions:t,loading:i,t:s,handleFetch:r,handleChange:g}}});function Kt(e,n,a,i,l,f){const p=S("LoadingOutlined"),s=S("Select");return C(),R(s,Z({onDropdownVisibleChange:e.handleFetch},e.$attrs,{onChange:e.handleChange,options:e.getOptions,value:e.state,"onUpdate:value":n[0]||(n[0]=o=>e.state=o)}),fe({_:2},[ie(Object.keys(e.$slots),o=>({name:o,fn:F(t=>[me(e.$slots,o,te(ge(t||{})))])})),e.loading?{name:"suffixIcon",fn:F(()=>[y(p,{spin:""})]),key:"0"}:void 0,e.loading?{name:"notFoundContent",fn:F(()=>[ae("span",null,[y(p,{spin:"",class:"mr-1"}),K(" "+E(e.t("component.form.apiSelectNotFound")),1)])]),key:"1"}:void 0]),1040,["onDropdownVisibleChange","onChange","options","value"])}const Ht=V(zt,[["render",Kt]]),Vt=G({name:"ApiTree",components:{ATree:ft},props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},resultField:w.string.def(""),afterFetch:{type:Function},value:{type:Array}},emits:["options-change","change","update:value"],setup(e,{attrs:n,emit:a}){const i=_([]),l=_(!1),f=_(!1),p=_([]),[s]=oe(e,"value","change",p),o=P(()=>k(k({},e.api?{treeData:L(i)}:{}),n));I(()=>s.value,u=>{a("update:value",u)}),I(()=>e.params,()=>{!L(l)&&t()},{deep:!0}),I(()=>e.immediate,u=>{u&&!l.value&&t()}),Ae(()=>{e.immediate&&t()});function t(){return B(this,null,function*(){const{api:u,afterFetch:r}=e;if(!u||!H(u))return;f.value=!0,i.value=[];let c;try{c=yield u(e.params)}catch(g){}r&&H(r)&&(c=r(c)),f.value=!1,c&&(ne(c)||(c=Q(c,e.resultField)),i.value=c||[],l.value=!0,a("options-change",i.value))})}return{getAttrs:o,loading:f,state:s}}});function Wt(e,n,a,i,l,f){const p=S("a-tree");return C(),R(p,Z(e.getAttrs,{selectedKeys:e.state,"onUpdate:selectedKeys":n[0]||(n[0]=s=>e.state=s)}),fe({_:2},[ie(Object.keys(e.$slots),s=>({name:s,fn:F(o=>[me(e.$slots,s,te(ge(o||{})))])}))]),1040,["selectedKeys"])}const qt=V(Vt,[["render",Wt]]),Zt=G({name:"ApiTreeSelect",components:{ATreeSelect:Be,LoadingOutlined:Ce},props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},async:{type:Boolean,default:!1},resultField:w.string.def(""),labelField:w.string.def("title"),valueField:w.string.def("value"),childrenField:w.string.def("children")},emits:["options-change","change","load-data"],setup(e,{attrs:n,emit:a}){const i=_([]),l=_(!1),f=_(!1),p=P(()=>k(k({},e.api?{treeData:L(i)}:{}),n)),s={children:e.childrenField,value:e.valueField,label:e.labelField};function o(...r){a("change",...r)}I(()=>e.params,()=>{!L(l)&&u()},{deep:!0}),I(()=>e.immediate,r=>{r&&!l.value&&u()}),Ae(()=>{e.immediate&&u()});function t(r){return new Promise(c=>{if(ne(r.children)&&r.children.length>0){c();return}a("load-data",{treeData:i,treeNode:r,resolve:c})})}function u(){return B(this,null,function*(){const{api:r}=e;if(!r||!H(r)||f.value)return;f.value=!0,i.value=[];let c;try{c=yield r(e.params)}catch(g){}f.value=!1,c&&(ne(c)||(c=Q(c,e.resultField)),i.value=c||[],l.value=!0,a("options-change",i.value))})}return{getAttrs:p,loading:f,handleChange:o,fieldNames:s,onLoadData:t}}});function Xt(e,n,a,i,l,f){const p=S("LoadingOutlined"),s=S("a-tree-select");return C(),R(s,Z(e.getAttrs,{onChange:e.handleChange,"field-names":e.fieldNames,"load-data":e.async?e.onLoadData:void 0}),fe({_:2},[ie(Object.keys(e.$slots),o=>({name:o,fn:F(t=>[me(e.$slots,o,te(ge(t||{})))])})),e.loading?{name:"suffixIcon",fn:F(()=>[y(p,{spin:""})]),key:"0"}:void 0]),1040,["onChange","field-names","load-data"])}const Yt=V(Zt,[["render",Xt]]),Qt=G({name:"ApiCascader",components:{LoadingOutlined:Ce,[Se.name]:Se},props:{value:{type:Array},api:{type:Function,default:null},numberToString:w.bool,resultField:w.string.def(""),labelField:w.string.def("label"),valueField:w.string.def("value"),childrenField:w.string.def("children"),apiParamKey:w.string.def("parentCode"),immediate:w.bool.def(!0),initFetchParams:{type:Object,default:()=>({})},isLeaf:{type:Function,default:null},displayRenderArray:{type:Array}},emits:["change","defaultChange"],setup(e,{emit:n}){const a=_([]),i=_([]),l=_(!1),f=_([]),p=_(!0),{t:s}=X(),[o]=oe(e,"value","change",f);I(a,d=>{const m=t(d);i.value=m},{deep:!0});function t(d){const{labelField:m,valueField:h,numberToString:v,childrenField:$,isLeaf:U}=e;return d.reduce((j,J)=>{if(J){const re=J[h],ue=Y(k({},le(J,[m,h])),{label:J[m],value:v?`${re}`:re,isLeaf:U&&typeof U=="function"?U(J):!1}),A=Reflect.get(J,$);A&&Reflect.set(ue,$,t(A)),j.push(ue)}return j},[])}function u(){return B(this,null,function*(){const d=e.api;if(!(!d||!H(d))){a.value=[],l.value=!0;try{const m=yield d(e.initFetchParams);if(Array.isArray(m)){a.value=m;return}e.resultField&&(a.value=Q(m,e.resultField)||[])}catch(m){}finally{l.value=!1}}})}function r(d){return B(this,null,function*(){const m=d[d.length-1];m.loading=!0;const h=e.api;if(!(!h||!H(h)))try{const v=yield h({[e.apiParamKey]:Reflect.get(m,"value")});if(Array.isArray(v)){const $=t(v);m.children=$;return}if(e.resultField){const $=t(Q(v,e.resultField)||[]);m.children=$}}catch(v){}finally{m.loading=!1}})}_e(()=>{e.immediate&&u()}),I(()=>e.initFetchParams,()=>{!L(p)&&u()},{deep:!0});function c(d,m){f.value=m,n("defaultChange",d,m)}function g({labels:d,selectedOptions:m}){return L(f).length===m.length?d.join(" / "):e.displayRenderArray?e.displayRenderArray.join(" / "):""}return{state:o,options:i,loading:l,t:s,handleChange:c,loadData:r,handleRenderDisplay:g}}});function Jt(e,n,a,i,l,f){const p=S("LoadingOutlined"),s=S("a-cascader");return C(),R(s,{value:e.state,"onUpdate:value":n[0]||(n[0]=o=>e.state=o),options:e.options,"load-data":e.loadData,"change-on-select":"",onChange:e.handleChange,displayRender:e.handleRenderDisplay},fe({_:2},[e.loading?{name:"suffixIcon",fn:F(()=>[y(p,{spin:""})]),key:"0"}:void 0,e.loading?{name:"notFoundContent",fn:F(()=>[ae("span",null,[y(p,{spin:"",class:"mr-1"}),K(" "+E(e.t("component.form.apiSelectNotFound")),1)])]),key:"1"}:void 0]),1032,["value","options","load-data","onChange","displayRender"])}const xt=V(Qt,[["render",Jt]]),en=G({name:"ApiTransfer",components:{Transfer:mt},props:{value:{type:Array},api:{type:Function,default:null},params:{type:Object},dataSource:{type:Array},immediate:w.bool.def(!0),alwaysLoad:w.bool.def(!1),afterFetch:{type:Function},resultField:w.string.def(""),labelField:w.string.def("title"),valueField:w.string.def("key"),showSearch:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterOption:{type:Function},selectedKeys:{type:Array},showSelectAll:{type:Boolean,default:!1},targetKeys:{type:Array}},emits:["options-change","change"],setup(e,{attrs:n,emit:a}){const i=_([]),l=_([]),{t:f}=X(),p=P(()=>k(k({},e.api?{}:{dataSource:L(i)}),n)),s=P(()=>{const{labelField:c,valueField:g}=e;return L(i).reduce((d,m)=>(m&&d.push(Y(k({},le(m,[c,g])),{title:m[c],key:m[g]})),d),[])}),o=P(()=>Array.isArray(e.value)?e.value:Array.isArray(e.targetKeys)?e.targetKeys:[]);function t(c,g,d){l.value=c,a("change",c)}_e(()=>{e.immediate&&!e.alwaysLoad&&u()}),I(()=>e.params,()=>{u()},{deep:!0});function u(){return B(this,null,function*(){const c=e.api;if(!c||!H(c)){Array.isArray(e.dataSource)&&(i.value=e.dataSource);return}i.value=[];try{const g=yield c(e.params);if(Array.isArray(g)){i.value=g,r();return}e.resultField&&(i.value=Q(g,e.resultField)||[]),r()}catch(g){}})}function r(){a("options-change",L(s))}return{getTargetKeys:o,getdataSource:s,t:f,getAttrs:p,handleChange:t}}});function tn(e,n,a,i,l,f){const p=S("Transfer");return C(),R(p,{"data-source":e.getdataSource,"filter-option":e.filterOption,render:s=>s.title,showSelectAll:e.showSelectAll,selectedKeys:e.selectedKeys,targetKeys:e.getTargetKeys,showSearch:e.showSearch,disabled:e.disabled,onChange:e.handleChange},null,8,["data-source","filter-option","render","showSelectAll","selectedKeys","targetKeys","showSearch","disabled","onChange"])}const nn=V(en,[["render",tn]]),an=G({name:"ImageUpload",components:{PlusOutlined:gt,AUpload:ce,AModal:ht},inheritAttrs:!1,props:{value:[Array,String],api:{type:Function,default:null},listType:{type:String,default:()=>"picture-card"},fileType:{type:Array,default:()=>["image/png","image/jpeg"]},multiple:{type:Boolean,default:()=>!1},maxCount:{type:Number,default:()=>1},minCount:{type:Number,default:()=>0},maxSize:{type:Number,default:()=>2}},emits:["change","update:value"],setup(e,{emit:n}){const a=we(),{t:i}=X(),l=_(!1),f=_(""),p=_(),s=_([]),[o]=oe(e,"value","change",p),t=je({newList:[],newStr:"",oldStr:""});I(()=>s.value,h=>{t.newList=h.filter(v=>(v==null?void 0:v.url)&&v.status==="done"&&nt(v==null?void 0:v.url)).map(v=>v==null?void 0:v.url),t.newStr=Te(t.newList),t.newStr!==t.oldStr&&(t.oldStr=t.newStr,p.value=e.multiple?t.newList:t.newStr,o.value=e.multiple?t.newList:t.newStr)},{deep:!0}),I(()=>o.value,h=>{u(h),n("update:value",h)});function u(h){const v=e.multiple?Te(h||[]):h||"";if(v!==t.oldStr){t.oldStr=v;let $=[];e.multiple?ke(h)&&(ne(h)?$=h:$.push(h)):ke(h)&&$.push(h),s.value=$.map(U=>{const j=Pt();return{uid:j,name:j,status:"done",url:U}})}}const r=()=>{l.value=!1},c=h=>B(this,null,function*(){!h.url&&!h.preview&&(h.preview=yield m(h.originFileObj)),f.value=h.url||h.preview,l.value=!0}),g=h=>{if(s.value.length>e.maxCount)return s.value.splice(e.maxCount,s.value.length-e.maxCount),he.error(i("component.upload.maxNumber",[e.maxCount])),ce.LIST_IGNORE;const v=e.fileType.includes(h.type);v||he.error(i("component.upload.acceptUpload",[e.fileType.toString()]));const $=h.size/1024/1024<e.maxSize;return $||he.error(i("component.upload.maxSizeMultiple",[e.maxSize])),v&&$||s.value.pop(),v&&$||ce.LIST_IGNORE},d=h=>B(this,null,function*(){const{file:v}=h;yield e.api(h).then($=>{v.url=$,v.status="done",s.value.pop(),s.value.push(v)}).catch(()=>{s.value.pop()})});function m(h){return new Promise((v,$)=>{const U=new FileReader;U.readAsDataURL(h),U.onload=()=>v(U.result),U.onerror=j=>$(j)})}return{previewOpen:l,fileList:s,state:o,attrs:a,t:i,handlePreview:c,handleBeforeUpload:g,handleCustomRequest:d,handleCancel:r,previewImage:f}}});const on={class:"clearfix"},ln={key:0},sn={style:{"margin-top":"8px"}},rn=["src"];function un(e,n,a,i,l,f){const p=S("plus-outlined"),s=S("a-upload"),o=S("a-modal");return C(),M("div",on,[y(s,Z({"file-list":e.fileList,"onUpdate:fileList":n[0]||(n[0]=t=>e.fileList=t),"list-type":e.listType,multiple:e.multiple,"max-count":e.maxCount,customRequest:e.handleCustomRequest,"before-upload":e.handleBeforeUpload},e.$attrs,{onPreview:e.handlePreview,value:e.state,"onUpdate:value":n[1]||(n[1]=t=>e.state=t)}),{default:F(()=>[e.fileList.length<e.maxCount?(C(),M("div",ln,[y(p),ae("div",sn,E(e.t("component.upload.upload")),1)])):z("",!0)]),_:1},16,["file-list","list-type","multiple","max-count","customRequest","before-upload","onPreview","value"]),y(o,{open:e.previewOpen,footer:null,onCancel:e.handleCancel},{default:F(()=>[ae("img",{alt:"example",style:{width:"100%"},src:e.previewImage},null,8,rn)]),_:1},8,["open","onCancel"])])}const dn=V(an,[["render",un],["__scopeId","data-v-4085a933"]]),He={helpText:{type:String,default:""},maxSize:{type:Number,default:2},maxNumber:{type:Number,default:1/0},accept:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!0},uploadParams:{type:Object,default:()=>({})},api:{type:Function,default:null,required:!0},name:{type:String,default:"file"},filename:{type:String,default:null},fileListOpenDrag:{type:Boolean,default:!0},fileListDragOptions:{type:Object,default:()=>({})}},cn=Y(k({value:{type:Array,default:()=>[]}},He),{showPreviewNumber:{type:Boolean,default:!0},emptyHidePreview:{type:Boolean,default:!1}}),pn={value:{type:Array,default:()=>[]}},fn={columns:{type:Array,default:null},actionColumn:{type:Object,default:null},dataSource:{type:Array,default:null},openDrag:{type:Boolean,default:!1},dragOptions:{type:Object,default:()=>({})}},{t:be}=X();function mn({acceptRef:e,helpTextRef:n,maxNumberRef:a,maxSizeRef:i}){const l=P(()=>{const s=L(e);return s&&s.length>0?s:[]}),f=P(()=>L(l).map(s=>s.indexOf("/")>0||s.startsWith(".")?s:`.${s}`).join(",")),p=P(()=>{const s=L(n);if(s)return s;const o=[],t=L(e);t.length>0&&o.push(be("component.upload.accept",[t.join(",")]));const u=L(i);u&&o.push(be("component.upload.maxSize",[u]));const r=L(a);return r&&r!==1/0&&o.push(be("component.upload.maxNumber",[r])),o.join("，")});return{getAccept:l,getStringAccept:f,getHelpText:p}}var O=(e=>(e.SUCCESS="success",e.ERROR="error",e.UPLOADING="uploading",e))(O||{});function gn(e){return Ve(e.name)}function Ve(e){return/\.(jpg|jpeg|png|gif|webp)$/i.test(e)}function hn(e){return new Promise((n,a)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>n({result:i.result,file:e}),i.onerror=l=>a(l)})}const We=Symbol("basic-table");function la(e){Lt(We,e)}function yn(){return kt(We)}const{table:vn}=at,{pageSizeOptions:bn,defaultPageSize:Sn,fetchSetting:wn,defaultSize:Cn,defaultSortFn:_n,defaultFilterFn:An}=vn,sa="key",ia=bn,ra=Sn,ua=wn,da=Cn,ca=_n,pa=An,fa="center",ma="INDEX",Fn="ACTION",$n=G({name:"TableAction",components:{Icon:Oe,PopConfirmButton:ot,Divider:Ne,Dropdown:lt,MoreOutlined:yt,Tooltip:Me},props:{actions:{type:Array,default:null},dropDownActions:{type:Array,default:null},divider:w.bool.def(!0),outside:w.bool,stopButtonPropagation:w.bool.def(!1)},setup(e){const{prefixCls:n}=st("basic-table-action");let a={};e.outside||(a=yn());const{hasPermission:i}=it();function l(u){const r=u.ifShow;let c=!0;return ut(r)&&(c=r),H(r)&&(c=r(u)),c}const f=P(()=>(Pe(e.actions)||[]).filter(u=>i(u.auth)&&l(u)).map(u=>{const{popConfirm:r}=u;return Y(k(k({getPopupContainer:()=>{var c;return(c=L(a==null?void 0:a.wrapRef))!=null?c:document.body},type:"link",size:"small"},u),r||{}),{onConfirm:r==null?void 0:r.confirm,onCancel:r==null?void 0:r.cancel,enable:!!r})})),p=P(()=>{const u=(Pe(e.dropDownActions)||[]).filter(r=>i(r.auth)&&l(r));return u.map((r,c)=>{const{label:g,popConfirm:d}=r;return Y(k(k({},r),d),{onConfirm:d==null?void 0:d.confirm,onCancel:d==null?void 0:d.cancel,text:g,divider:c<u.length-1?e.divider:!1})})}),s=P(()=>{var c,g;const r=(((c=a==null?void 0:a.getColumns)==null?void 0:c.call(a))||[]).find(d=>d.flag===Fn);return(g=r==null?void 0:r.align)!=null?g:"left"});function o(u){return k({getPopupContainer:()=>{var r;return(r=L(a==null?void 0:a.wrapRef))!=null?r:document.body},placement:"bottom"},rt(u)?{title:u}:u)}function t(u){if(!e.stopButtonPropagation)return;u.composedPath().find(g=>{var d;return((d=g.tagName)==null?void 0:d.toUpperCase())==="BUTTON"})&&u.stopPropagation()}return{prefixCls:n,getActions:f,getDropdownList:p,getAlign:s,onCellClick:t,getTooltip:o}}});function Ln(e,n,a,i,l,f){const p=S("Icon"),s=S("PopConfirmButton"),o=S("Tooltip"),t=S("Divider"),u=S("MoreOutlined"),r=S("a-button"),c=S("Dropdown");return C(),M("div",{class:ve([e.prefixCls,e.getAlign]),onClick:n[0]||(n[0]=(...g)=>e.onCellClick&&e.onCellClick(...g))},[(C(!0),M(ee,null,ie(e.getActions,(g,d)=>(C(),M(ee,{key:`${d}-${g.label}`},[g.tooltip?(C(),R(o,te(Z({key:0},e.getTooltip(g.tooltip))),{default:F(()=>[y(s,te(ge(g)),{default:F(()=>[g.icon?(C(),R(p,{key:0,icon:g.icon,class:ve({"mr-1":!!g.label})},null,8,["icon","class"])):z("",!0),g.label?(C(),M(ee,{key:1},[K(E(g.label),1)],64)):z("",!0)]),_:2},1040)]),_:2},1040)):(C(),R(s,te(Z({key:1},g)),{default:F(()=>[g.icon?(C(),R(p,{key:0,icon:g.icon,class:ve({"mr-1":!!g.label})},null,8,["icon","class"])):z("",!0),g.label?(C(),M(ee,{key:1},[K(E(g.label),1)],64)):z("",!0)]),_:2},1040)),e.divider&&d<e.getActions.length-1?(C(),R(t,{key:2,type:"vertical",class:"action-divider"})):z("",!0)],64))),128)),e.dropDownActions&&e.getDropdownList.length>0?(C(),R(c,{key:0,trigger:["hover"],dropMenuList:e.getDropdownList,popconfirm:""},{default:F(()=>[me(e.$slots,"more"),e.$slots.more?z("",!0):(C(),R(r,{key:0,type:"link",size:"small"},{default:F(()=>[y(u,{class:"icon-more"})]),_:1}))]),_:3},8,["dropMenuList"])):z("",!0)],2)}const qe=V($n,[["render",Ln]]),kn=G({components:{Image:vt},props:{fileUrl:w.string.def(""),fileName:w.string.def("")}});const Rn={class:"thumb"};function Tn(e,n,a,i,l,f){const p=S("Image");return C(),M("span",Rn,[e.fileUrl?(C(),R(p,{key:0,src:e.fileUrl,width:104},null,8,["src"])):z("",!0)])}const Ze=V(kn,[["render",Tn]]),{t:D}=X();function Pn(){return[{dataIndex:"thumbUrl",title:D("component.upload.legend"),width:100,customRender:({record:e})=>{const{thumbUrl:n}=e||{};return n&&y(Ze,{fileUrl:n},null)}},{dataIndex:"name",title:D("component.upload.fileName"),align:"left",customRender:({text:e,record:n})=>{const{percent:a,status:i}=n||{};let l="normal";return i===O.ERROR?l="exception":i===O.UPLOADING?l="active":i===O.SUCCESS&&(l="success"),y("div",null,[y("p",{class:"truncate mb-1 max-w-[280px]",title:e},[e]),y(bt,{percent:a,size:"small",status:l},null)])}},{dataIndex:"size",title:D("component.upload.fileSize"),width:100,customRender:({text:e=0})=>e&&(e/1024).toFixed(2)+"KB"},{dataIndex:"status",title:D("component.upload.fileStatue"),width:100,customRender:({text:e})=>e===O.SUCCESS?y(ye,{color:"green"},{default:()=>D("component.upload.uploadSuccess")}):e===O.ERROR?y(ye,{color:"red"},{default:()=>D("component.upload.uploadError")}):e===O.UPLOADING?y(ye,{color:"blue"},{default:()=>D("component.upload.uploading")}):e||D("component.upload.pending")}]}function Un(e){return{width:120,title:D("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:n})=>{const a=[{label:D("component.upload.del"),color:"error",onClick:e.bind(null,n)}];return y(qe,{actions:a,outside:!0},null)}}}function In(){return[{dataIndex:"url",title:D("component.upload.legend"),width:100,customRender:({record:e})=>{const{url:n}=e||{};return Ve(n)&&y(Ze,{fileUrl:n},null)}},{dataIndex:"name",title:D("component.upload.fileName"),align:"left"}]}function On({handleRemove:e,handleDownload:n}){return{width:160,title:D("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:a})=>{const i=[{label:D("component.upload.del"),color:"error",onClick:e.bind(null,a)},{label:D("component.upload.download"),onClick:n.bind(null,a)}];return y(qe,{actions:i,outside:!0},null)}}}const Xe=G({name:"FileList",props:fn,setup(e,{emit:n}){const a=It(),i=_();return I(()=>e.dataSource,()=>{Ue(()=>{var l;(l=a==null?void 0:a.redoModalHeight)==null||l.call(a)})}),e.openDrag&&Ae(()=>Ot(i,Y(k({},e.dragOptions),{onEnd:({oldIndex:l,newIndex:f})=>{if(l===f)return;const{onAfterEnd:p}=e.dragOptions;if(Re(l)&&Re(f)){const s=[...e.dataSource],[o]=s.splice(l,1);s.splice(f,0,o),Ue(()=>{n("update:dataSource",s),H(p)&&p(s)})}}})).initSortable()),()=>{const{columns:l,actionColumn:f,dataSource:p}=e,s=[...l,f];return y("div",{class:"overflow-x-auto"},[y("table",{class:"file-table"},[y("colgroup",null,[s.map(o=>{const{width:t=0,dataIndex:u}=o,r={width:`${t}px`,minWidth:`${t}px`};return y("col",{style:t?r:{},key:u},null)})]),y("thead",null,[y("tr",{class:"file-table-tr"},[s.map(o=>{const{title:t="",align:u="center",dataIndex:r}=o;return y("th",{class:["file-table-th",u],key:r},[t])})])]),y("tbody",{ref:i},[p.map((o={},t)=>y("tr",{class:"file-table-tr",key:`${t+o.name||""}`},[s.map(u=>{const{dataIndex:r="",customRender:c,align:g="center"}=u,d=c&&H(c);return y("td",{class:["file-table-td break-all",g],key:r},[d?c==null?void 0:c({text:o[r],record:o}):o[r]])})]))])])])}}});const Dn=G({components:{BasicModal:ze,Upload:ce,Alert:St,FileList:Xe},props:Y(k({},He),{previewFileList:{type:Array,default:()=>[]}}),emits:["change","register","delete"],setup(e,{emit:n}){const a=je({fileList:[]}),i=_(!1),l=_([]),{accept:f,helpText:p,maxNumber:s,maxSize:o}=Rt(e),{t}=X(),[u,{closeModal:r}]=Ke(),{getStringAccept:c,getHelpText:g}=mn({acceptRef:f,helpTextRef:p,maxNumberRef:s,maxSizeRef:o}),{createMessage:d}=dt(),m=P(()=>l.value.length>0&&!l.value.every(A=>A.status===O.SUCCESS)),h=P(()=>{const A=l.value.some(T=>T.status===O.SUCCESS);return{disabled:i.value||l.value.length===0||!A}}),v=P(()=>{const A=l.value.some(T=>T.status===O.ERROR);return i.value?t("component.upload.uploading"):t(A?"component.upload.reUploadFailed":"component.upload.startUpload")});function $(A){const{size:T,name:N}=A,{maxSize:W}=e;if(W&&A.size/1024/1024>=W)return d.error(t("component.upload.maxSizeMultiple",[W])),!1;const q={uuid:Ut(),file:A,size:T,name:N,percent:0,type:N.split(".").pop()};return gn(A)?hn(A).then(({result:x})=>{l.value=[...L(l),k({thumbUrl:x},q)]}):l.value=[...L(l),q],!1}function U(A){const T=l.value.findIndex(N=>N.uuid===A.uuid);T!==-1&&l.value.splice(T,1),n("delete",A)}function j(A){return B(this,null,function*(){var N;const{api:T}=e;if(!T||!H(T))return ct();try{A.status=O.UPLOADING;const W=yield(N=e.api)==null?void 0:N.call(e,{data:k({},e.uploadParams||{}),file:A.file,name:e.name,filename:e.filename},function(Fe){const Ye=Fe.loaded/Fe.total*100|0;A.percent=Ye}),{data:q}=W;return A.status=O.SUCCESS,A.responseData=q,{success:!0,error:null}}catch(W){return A.status=O.ERROR,{success:!1,error:W}}})}function J(){return B(this,null,function*(){var T;const{maxNumber:A}=e;if(l.value.length+((T=e.previewFileList)==null?void 0:T.length)>A)return d.warning(t("component.upload.maxNumber",[A]));try{i.value=!0;const N=l.value.filter(x=>x.status!==O.SUCCESS)||[],W=yield Promise.all(N.map(x=>j(x)));i.value=!1;const q=W.filter(x=>!x.success);if(q.length>0)throw q}catch(N){throw i.value=!1,N}})}function re(){const{maxNumber:A}=e;if(l.value.length>A)return d.warning(t("component.upload.maxNumber",[A]));if(i.value)return d.warning(t("component.upload.saveWarn"));const T=[];for(const N of l.value){const{status:W,responseData:q}=N;W===O.SUCCESS&&q&&T.push(q.url)}if(T.length<=0)return d.warning(t("component.upload.saveError"));l.value=[],r(),n("change",T)}function ue(){return B(this,null,function*(){return i.value?(d.warning(t("component.upload.uploadWait")),!1):(l.value=[],!0)})}return{columns:Pn(),actionColumn:Un(U),register:u,closeModal:r,getHelpText:g,getStringAccept:c,getOkButtonProps:h,beforeUpload:$,fileListRef:l,state:a,isUploadingRef:i,handleStartUpload:J,handleOk:re,handleCloseFunc:ue,getIsSelectFile:m,getUploadBtnText:v,t}}});const Bn={class:"upload-modal-toolbar"};function Nn(e,n,a,i,l,f){const p=S("a-button"),s=S("Alert"),o=S("Upload"),t=S("FileList"),u=S("BasicModal");return C(),R(u,Z({width:"800px",title:e.t("component.upload.upload"),okText:e.t("component.upload.save")},e.$attrs,{onRegister:e.register,onOk:e.handleOk,closeFunc:e.handleCloseFunc,maskClosable:!1,keyboard:!1,class:"upload-modal",okButtonProps:e.getOkButtonProps,cancelButtonProps:{disabled:e.isUploadingRef}}),{centerFooter:F(()=>[y(p,{onClick:e.handleStartUpload,color:"success",disabled:!e.getIsSelectFile,loading:e.isUploadingRef},{default:F(()=>[K(E(e.getUploadBtnText),1)]),_:1},8,["onClick","disabled","loading"])]),default:F(()=>[ae("div",Bn,[y(s,{message:e.getHelpText,type:"info",banner:"",class:"upload-modal-toolbar__text"},null,8,["message"]),y(o,{accept:e.getStringAccept,multiple:e.multiple,"before-upload":e.beforeUpload,"show-upload-list":!1,class:"upload-modal-toolbar__btn"},{default:F(()=>[y(p,{type:"primary"},{default:F(()=>[K(E(e.t("component.upload.choose")),1)]),_:1})]),_:1},8,["accept","multiple","before-upload"])]),y(t,{dataSource:e.fileListRef,"onUpdate:dataSource":n[0]||(n[0]=r=>e.fileListRef=r),columns:e.columns,actionColumn:e.actionColumn,openDrag:e.fileListOpenDrag,dragOptions:e.fileListDragOptions},null,8,["dataSource","columns","actionColumn","openDrag","dragOptions"])]),_:1},16,["title","okText","onRegister","onOk","closeFunc","okButtonProps","cancelButtonProps"])}const Mn=V(Dn,[["render",Nn]]),En=G({components:{BasicModal:ze,FileList:Xe},props:pn,emits:["list-change","register","delete"],setup(e,{emit:n}){const[a,{closeModal:i}]=Ke(),{t:l}=X(),f=_([]);I(()=>e.value,o=>{ne(o)||(o=[]),f.value=o.filter(t=>!!t).map(t=>({url:t,type:t.split(".").pop()||"",name:t.split("/").pop()||""}))},{immediate:!0});function p(o){const t=f.value.findIndex(u=>u.url===o.url);if(t!==-1){const u=f.value.splice(t,1);n("delete",u[0].url),n("list-change",f.value.map(r=>r.url))}}function s(o){const{url:t=""}=o;Dt({url:t})}return{t:l,register:a,closeModal:i,fileListRef:f,columns:In(),actionColumn:On({handleRemove:p,handleDownload:s})}}});function Gn(e,n,a,i,l,f){const p=S("FileList"),s=S("BasicModal");return C(),R(s,Z({width:"800px",title:e.t("component.upload.preview"),class:"upload-preview-modal"},e.$attrs,{onRegister:e.register,showOkBtn:!1}),{default:F(()=>[y(p,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])]),_:1},16,["title","onRegister"])}const jn=V(En,[["render",Gn]]),zn=G({name:"BasicUpload",components:{UploadModal:Mn,Space:wt,UploadPreviewModal:jn,Icon:Oe,Tooltip:Me},props:cn,emits:["change","delete","preview-delete","update:value"],setup(e,{emit:n,attrs:a}){const{t:i}=X(),[l,{openModal:f}]=Ie(),[p,{openModal:s}]=Ie(),o=_([]),t=P(()=>{const{emptyHidePreview:m}=e;return m&&m?o.value.length>0:!0}),u=P(()=>{const m=k(k({},a),e);return le(m,"onChange")});I(()=>e.value,(m=[])=>{o.value=ne(m)?m:[]},{immediate:!0});function r(m){o.value=[...L(o),...m||[]],n("update:value",o.value),n("change",o.value)}function c(m){o.value=[...m||[]],n("update:value",o.value),n("change",o.value)}function g(m){n("delete",m)}function d(m){n("preview-delete",m)}return{registerUploadModal:l,openUploadModal:f,handleChange:r,handlePreviewChange:c,registerPreviewModal:p,openPreviewModal:s,fileList:o,showPreview:t,bindValue:u,handleDelete:g,handlePreviewDelete:d,t:i}}});function Kn(e,n,a,i,l,f){const p=S("a-button"),s=S("Icon"),o=S("Tooltip"),t=S("Space"),u=S("UploadModal"),r=S("UploadPreviewModal");return C(),M("div",null,[y(t,null,{default:F(()=>[y(p,{type:"primary",onClick:e.openUploadModal,preIcon:"carbon:cloud-upload"},{default:F(()=>[K(E(e.t("component.upload.upload")),1)]),_:1},8,["onClick"]),e.showPreview?(C(),R(o,{key:0,placement:"bottom"},{title:F(()=>[K(E(e.t("component.upload.uploaded"))+" ",1),e.fileList.length?(C(),M(ee,{key:0},[K(E(e.fileList.length),1)],64)):z("",!0)]),default:F(()=>[y(p,{onClick:e.openPreviewModal},{default:F(()=>[y(s,{icon:"bi:eye"}),e.fileList.length&&e.showPreviewNumber?(C(),M(ee,{key:0},[K(E(e.fileList.length),1)],64)):z("",!0)]),_:1},8,["onClick"])]),_:1})):z("",!0)]),_:1}),y(u,Z(e.bindValue,{previewFileList:e.fileList,fileListOpenDrag:e.fileListOpenDrag,fileListDragOptions:e.fileListDragOptions,onRegister:e.registerUploadModal,onChange:e.handleChange,onDelete:e.handleDelete}),null,16,["previewFileList","fileListOpenDrag","fileListDragOptions","onRegister","onChange","onDelete"]),y(r,{value:e.fileList,onRegister:e.registerPreviewModal,onListChange:e.handlePreviewChange,onDelete:e.handlePreviewDelete},null,8,["value","onRegister","onListChange","onDelete"])])}const Hn=V(zn,[["render",Kn]]),Vn=pt(Hn),b=new Map;b.set("Input",se);b.set("InputGroup",se.Group);b.set("InputPassword",se.Password);b.set("InputSearch",se.Search);b.set("InputTextArea",se.TextArea);b.set("InputNumber",Ct);b.set("AutoComplete",_t);b.set("ImageUpload",dn);b.set("Select",De);b.set("ApiSelect",Ht);b.set("ApiTree",qt);b.set("TreeSelect",Be);b.set("ApiTreeSelect",Yt);b.set("ApiRadioGroup",jt);b.set("Switch",At);b.set("RadioButtonGroup",Tt);b.set("RadioGroup",de.Group);b.set("Checkbox",Ee);b.set("CheckboxGroup",Ee.Group);b.set("ApiCascader",xt);b.set("Cascader",Se);b.set("Slider",Ft);b.set("Rate",$t);b.set("ApiTransfer",nn);b.set("DatePicker",pe);b.set("MonthPicker",pe.MonthPicker);b.set("RangePicker",pe.RangePicker);b.set("WeekPicker",pe.WeekPicker);b.set("TimePicker",Ge);b.set("TimeRangePicker",Ge.TimeRangePicker);b.set("StrengthMeter",Bt);b.set("IconPicker",Nt);b.set("InputCountDown",Mt);b.set("Upload",Vn);b.set("Divider",Ne);function ga(e,n){b.set(e,n)}export{Ht as A,Vn as B,fa as D,ua as F,ma as I,ra as P,sa as R,qe as T,ia as a,Yt as b,b as c,jt as d,Fn as e,ca as f,pa as g,da as h,la as i,ga as j,yn as u};
